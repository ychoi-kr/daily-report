# 営業日報システム要件定義書

## 1. システム概要

営業担当者が日々の活動を報告し、上長がフィードバックを行うための営業日報管理システム

## 2. 機能要件

### 2.1 日報作成機能
- 営業担当者は1日1件の日報を作成できる
- 日報には以下を記載：
  - 当日の課題・相談事項（Problem）
  - 翌日の活動計画（Plan）
  - 作成日時

### 2.2 訪問記録登録機能
- 1つの日報に対して複数の顧客訪問記録を登録可能
- 各訪問記録には以下を記載：
  - 訪問した顧客
  - 訪問内容
  - 訪問時刻（任意）

### 2.3 上長コメント機能
- 上長は日報に対してコメントを追加できる
- コメントは複数回追加可能
- コメント日時を記録

### 2.4 マスタ管理
- 営業マスタ：営業担当者の情報を管理
- 顧客マスタ：顧客情報を管理

## 3. データ構造

### 3.1 ER図

@doc/ER_DIAGRAM.md

## 4. テーブル定義詳細

### 4.1 営業マスタ（SALES_PERSON）
- **主キー**: sales_person_id
- **用途**: 営業担当者および管理者の情報を管理
- **特記事項**: is_managerフラグで管理者権限を識別

### 4.2 顧客マスタ（CUSTOMER）
- **主キー**: customer_id
- **用途**: 訪問対象となる顧客情報を管理
- **特記事項**: 会社情報と担当者情報を一元管理

### 4.3 日報（DAILY_REPORT）
- **主キー**: report_id
- **用途**: 1日1件の日報本体を管理
- **特記事項**: 
  - sales_person_idとreport_dateの組み合わせでユニーク制約を設定
  - problemとplanは必須項目

### 4.4 訪問記録（VISIT_RECORD）
- **主キー**: visit_id
- **用途**: 日報に紐づく個別の顧客訪問記録
- **特記事項**: 
  - 1つの日報に複数の訪問記録を登録可能
  - 訪問時刻は任意項目

### 4.5 上長コメント（MANAGER_COMMENT）
- **主キー**: comment_id
- **用途**: 管理者による日報へのフィードバック
- **特記事項**: 
  - 1つの日報に複数のコメント可能
  - manager_idはSALES_PERSONテーブルの管理者を参照

## 5. 追加検討事項

### 5.1 権限管理
- 営業担当者：自分の日報のみ編集可能
- 管理者：配下の営業担当者の日報を閲覧・コメント可能

### 5.2 バリデーション
- 同一日付の日報は1人1件まで
- 過去日付の日報は作成から一定期間後は編集不可

### 5.3 今後の拡張性
- 訪問記録への成果（受注額等）の追加
- 日報の承認ワークフロー
- 月次・四半期レポートの自動生成

## 6. 非機能要件（今後詳細化）

### 6.1 性能要件
- 日報一覧の表示は3秒以内
- 同時接続ユーザー数：100名想定

### 6.2 セキュリティ要件
- ログイン認証必須
- 通信はHTTPS化
- アクセスログの記録

### 6.3 運用要件
- バックアップ：日次
- 稼働時間：平日8:00-20:00（メンテナンス時間を除く）


## 7. 画面設計

@doc/SCREEN_DESIGN.md

## 8. API仕様書

@doc/API_SCHEME.md


## 9. テスト仕様書

@doc/TEST_DEFINITION.md